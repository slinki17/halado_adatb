<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <title>K√∂nyvek list√°z√°sa</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container py-5">
    <!-- Akt√≠v k√∂lcs√∂nz√©sek -->
    <h4>üì¶ K√∂lcs√∂nz√©sek:</h4>
    {% if borrowings %}
        <ul class="list-group mb-4">
            {% for b in borrowings %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    K√∂nyv: {{ b.copy.book.title }} (P√©ld√°ny ID: {{ b.copy.copy_id }})<br>
                    <small class="text-muted">Hat√°rid≈ë: {{ b.due }}</small>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-muted">Nincs akt√≠v k√∂lcs√∂nz√©se.</p>
    {% endif %}

    <!-- Akt√≠v foglal√°sok -->
    <h4>üîí Foglal√°sok:</h4>
    {% if reservations %}
        <ul class="list-group mb-4">
            {% for r in reservations %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    K√∂nyv: {{ r.copy.book.title }} (P√©ld√°ny ID: {{ r.copy.copy_id }})<br>
                    <small class="text-muted">Lej√°rat: {{ r.expiration_date }}</small>
                </li>
            {% endfor %}
        </ul>
    {% else %}
        <p class="text-muted">Nincs akt√≠v foglal√°sa.</p>
    {% endif %}

    <h2 class="mb-4">K√∂nyvek kezel√©se {{ user.name }} sz√°m√°ra</h2>

    {% for book in books %}
        <div class="card mb-4 shadow-sm">
            <div class="card-body">
                <h5 class="card-title">{{ book.title }}</h5>
                <h6 class="card-subtitle mb-2 text-muted">{{ book.author }}</h6>
                <p class="card-text">
                    <strong>M≈±faj:</strong> {{ book.genre }}<br>
                    <strong>Kiad√°si √©v:</strong> {{ book.year }}
                </p>

                <h6>P√©ld√°nyok:</h6>
                <ul class="list-group">
                    {% for copy in copy_list %}
                        {% if copy.book_id == book.book_id %}
                        <li class="list-group-item d-flex justify-content-between align-items-center">
                            <div>
                                <strong>ID:</strong> {{ copy.copy_id }} |
                                <strong>St√°tusz:</strong>
                                {% if copy.status == "1" or copy.status == 1 %}
                                    <span class="badge bg-success">El√©rhet≈ë</span>
                                {% elif copy.status == "2" or copy.status == 2 %}
                                    <span class="badge bg-warning text-dark">Foglalt</span>
                                {% elif copy.status == "3" or copy.status == 3 %}
                                    <span class="badge bg-secondary">K√∂lcs√∂nz√∂tt</span>
                                {% else %}
                                    <span class="badge bg-dark">Ismeretlen</span>
                                {% endif %}
                            </div>
                        
                            {% if copy.status == "1" or copy.status == 1 %}
                                <div>
                                    <a href="{% url 'reserve_copy' user.user_id copy.copy_id %}" class="btn btn-outline-primary btn-sm me-2">Foglal√°s</a>
                                    <a href="{% url 'borrow_copy' user.user_id copy.copy_id %}" class="btn btn-outline-success btn-sm">K√∂lcs√∂nz√©s</a>
                                </div>
                            {% elif copy.status == "3" or copy.status == 3 %}
                                <div>
                                    <a href="{% url 'return_copy' user.user_id copy.copy_id %}" class="btn btn-outline-danger btn-sm">Lead√°s</a>
                                </div>
                            {% endif %}
                        </li>
                        
                        {% endif %}
                    {% endfor %}
                </ul>
            </div>
        </div>
    {% endfor %}

    <a href="{% url 'select_user' %}" class="btn btn-secondary mt-4">‚¨Ö Vissza a felhaszn√°l√≥khoz</a>
</div>
</body>
</html>
